<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Fits gastric emptying time series from MRI or scintigraphic measurements
   using nonlinear mixed-model population fits with nlme and Bayesian methods with 
   Stan; computes derived parameters such as t50 and AUC.">
<title>Analyzing Gastric Emptying from MRI or Scintigraphy • gastempt</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Analyzing Gastric Emptying from MRI or Scintigraphy">
<meta property="og:description" content="Fits gastric emptying time series from MRI or scintigraphic measurements
   using nonlinear mixed-model population fits with nlme and Bayesian methods with 
   Stan; computes derived parameters such as t50 and AUC.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">gastempt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/gastempt.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dmenne/gastempt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="gastempt-fitting-gastric-emptying-curves">gastempt: Fitting gastric emptying curves<a class="anchor" aria-label="anchor" href="#gastempt-fitting-gastric-emptying-curves"></a>
</h1></div>
<p>Dieter Menne<br>
Menne Biomed Consulting Tübingen, Germany<br><a href="https://www.menne-biomed.de" class="external-link uri">https://www.menne-biomed.de</a><br><a href="mailto:dieter.menne@menne-biomed.de" class="email">dieter.menne@menne-biomed.de</a></p>
<!-- badges: start -->
<!-- badges: end --><p>A package and a <a href="https://shiny.rstudio.com/" class="external-link">Shiny</a> web application to create simulated gastric emptying data, and to analyze gastric emptying from clinical studies using a population fit with R and package <code>nlme</code>. In addition, Bayesian fits with <a href="https://mc-stan.org/" class="external-link">Stan</a> to handle critical cases are implemented.</p>
<p>Part of the work has been supported by section GI MRT, Klinik für Gastroenterologie und Hepatologie, Universitätsspital Zürich; thanks to Werner Schwizer and Andreas Steingötter for their contributions.</p>
<div class="section level3">
<h3 id="download">Download<a class="anchor" aria-label="anchor" href="#download"></a>
</h3>
<p>The package is available from <a href="https://CRAN.R-project.org/package=gastempt" class="external-link">CRAN</a> and github (<a href="https://github.com/dmenne/gastempt" class="external-link">source</a>, <a href="https://github.com/dmenne/gastempt/" class="external-link">documentation</a>). To install, use:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"dmenne/gastempt"</span>)</span></code></pre></div>
<p>Compilation of the Stan models needs several minutes.</p>
</div>
<div class="section level3">
<h3 id="shiny-online-interface">Shiny online interface<a class="anchor" aria-label="anchor" href="#shiny-online-interface"></a>
</h3>
<p>The web interface can be installed on your computer, or run as <a href="https://apps.menne-biomed.de/gastempt/" class="external-link">web app</a>.</p>
<p>Two <strong>models</strong> are implemented in the web interface</p>
<ul>
<li>
<code>linexp, vol = v0 * (1 + kappa * t / tempt) * exp(-t / tempt):</code>Recommended for gastric emptying curves with an initial volume overshoot from secretion. With parameter kappa &gt; 1, there is a maximum after t=0. When all emptying curves start with a steep drop, this model can be difficult to fit.</li>
<li>
<code>powexp, vol = v0 * exp(-(t / tempt) ^ beta):</code> The power exponential function introduced by Elashof et. al. to fit scintigraphic emptying data; this type of data does not have an initial overshoot by design. Compared to the <code>linexp</code> model, fitting <code>powexp</code> is more reliable and rarely fails to converge in the presence of noise and outliers. The power exponential can be useful with MRI data when there is an unusual late phase in emptying.</li>
</ul>
</div>
<div class="section level3">
<h3 id="methods-with-variants">Methods with variants<a class="anchor" aria-label="anchor" href="#methods-with-variants"></a>
</h3>
<ul>
<li>Population fits based on function <code>nlme</code> in package R <code>nlme</code>.</li>
<li>
<a href="https://menne-biomed.de/blog/tag:Stan" class="external-link">Stan-based fits</a>, both <a href="https://github.com/dmenne/gastempt/blob/main/inst/stan/linexp_gastro_1b.stan" class="external-link">without</a> and <a href="https://github.com/dmenne/gastempt/blob/main/inst/stan/linexp_gastro_2b.stan" class="external-link">with</a> covariance estimation. Thanks to priors, fitting with Bayesian methods also works for single records, even if stability strongly improves with more data sets available; see <a href="https://dmenne.github.io/gastempt/reference/stan_gastempt.html" class="external-link">stan_gastempt</a>. Some details can be found in <a href="https://menne-biomed.de/blog/ballot-and-bazaar" class="external-link">my blog</a>. The rationale for using Stan to fit non-linear curves is discussed <a href="https://menne-biomed.de/blog/breath-test-stan" class="external-link">here</a> for <sup>13</sup>C breath test data, but is equally valid for gastric emptying data.</li>
</ul>
</div>
<div class="section level3">
<h3 id="data-entry">Data entry:<a class="anchor" aria-label="anchor" href="#data-entry"></a>
</h3>
<ul>
<li>Data can be entered directly from the clipboard copied from Excel, or can be simulated using a Shiny app.</li>
<li>Several preset simulations are provided in the Shiny app, with different amounts of noise and outliers</li>
<li>Robustness of models can be tested by manipulating noise quality and between-subject variance.</li>
<li>Fits are displayed with data.</li>
<li>The coefficients of the analysis including half-emptying time <em>t50</em> and the slope at time <em>t50</em> can be downloaded in .csv format.</li>
</ul>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>Program with simulated data (needs about 40 seconds till plot shows):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(gastempt)</span>
<span id="cb2-2"><a href="#cb2-2"></a>dd =<span class="st"> </span><span class="kw">simulate_gastempt</span>(<span class="dt">n_records =</span> <span class="dv">6</span>, <span class="dt">seed =</span> <span class="dv">471</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>d =<span class="st"> </span>dd<span class="op">$</span>data</span>
<span id="cb2-4"><a href="#cb2-4"></a>ret =<span class="st"> </span><span class="kw">stan_gastempt</span>(d)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw">print</span>(ret<span class="op">$</span>coef)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="kw">print</span>(ret<span class="op">$</span>plot)</span></code></pre></div>
<div class="figure">
<img src="tools/readme/screenshot.png" alt=""><p class="caption">Screenshot</p>
</div>
</div>
<div class="section level3">
<h3 id="installing-docker">Installing Docker<a class="anchor" aria-label="anchor" href="#installing-docker"></a>
</h3>
<ul>
<li>For Windows 10, you can get the installer from the <a href="https://docs.docker.com/desktop/windows/install/" class="external-link">Docker store</a>. For installation details, see <a href="https://docs.docker.com/docker-for-windows/install/" class="external-link">here</a>.<br>
</li>
<li>Linux users know how to install Docker anyway.</li>
</ul>
</div>
<div class="section level3">
<h3 id="installing-gastempt">Installing <code>gastempt</code>
<a class="anchor" aria-label="anchor" href="#installing-gastempt"></a>
</h3>
<ul><li>From the command line, enter the following to start the container</li></ul>
<!-- --><div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>docker run <span class="op">--</span>name gastempt  <span class="op">--</span>restart unless<span class="op">-</span>stopped <span class="op">-</span>p <span class="dv">3838</span><span class="op">:</span><span class="dv">3838</span> <span class="op">-</span>d dmenne<span class="op">/</span>gastempt</span></code></pre></div>
<ul>
<li>The first startup needs some time because 1 GB has to be downloaded. Subsequent startups require only a few seconds.</li>
<li>Connect to the app with your browser via <code>localhost:3838</code>.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=gastempt" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/dmenne/gastempt/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/dmenne/gastempt/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=3)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing gastempt</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Dieter Menne <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/dmenne/gastempt/actions" class="external-link"><img src="https://github.com/dmenne/gastempt/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://cran.r-project.org/package=gastempt" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/gastempt" alt="Downloads"></a></li>
<li><a href="https://app.codecov.io/gh/dmenne/gastempt" class="external-link"><img src="https://codecov.io/gh/dmenne/gastempt/branch/main/graph/badge.svg?token=estAZKCvn4" alt="codecov"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dieter Menne.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
